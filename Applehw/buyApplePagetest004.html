<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>buyApplePage</title>
    <link rel="stylesheet" href="/reset.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
        integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">
    <style>
        .color p {
            margin-bottom: 0;
        }

        .color {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;

        }

        .accordin-item:nth-child(2) span:nth-child(2)::before {
            content: 'NT$';
        }

        .text {
            padding: 0px 20px;
            margin: 10px 10px 0px 10px;
        }

        .button {
            width: 30%;
            height: 100px;
            margin: 5px 10px;
        }

        .color {
            font-size: 12px;
        }

        .color span {
            content: '';
            display: block;
            width: 30px;
            height: 30px;
            border-radius: 50%;
        }


        .button span:nth-child(1) {
            font-size: 14px;
            color: #000;
            font-weight: 700;
        }

        .button span:nth-child(2)::before {
            content: 'NT$'
        }

        .button span:nth-child(2)::after {
            content: '起'
        }

        .button span:nth-child(2) {
            font-size: 12px;
        }

        .accordion-button {
            display: block;
        }

        .accordion-button[aria-expanded='true'] {
            display: none;
        }
    </style>
</head>

<body>
    <!-- 切換頁面 -->

    <header class="d-flex justify-content-center align-items-center">
        <a href="#" class="fs-2 text-black me-5"><i class="fab fa-apple"></i></a>
        <button id="ipadbtn">ipad</button>
        <button id="iphonebtn">iphone</button>
        <button id="macprobtn">macpro</button>
    </header>

    <section class="container">
        <div class="row">
            <div class="col-md-6 col-12">
                <div class="photo text-end">
                    <!-- img (O)-->
                </div>
            </div>
            <div class="col-md-6 col-12">
                <div class="content">
                    <p class="fs-1 fw-bold">購買iPad Air</p>
                    <div class="accordion" id="accordionPanelsStayOpenExample">
                        <div class="accordion-item">
                            <button class="accordion-button displayColor" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            </button>
                            <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                                data-bs-parent="#accordionExample">
                                <div class="text fw-bold">外觀</div>
                                <div class="accordion-body d-flex flex-wrap device-color">
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <button class="accordion-button collapsed displayRam" type="button"
                                data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false"
                                aria-controls="collapseTwo">
                            </button>
                            <div id="collapseTwo" class="accordion-collapse collapse device"
                                aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    <div class="text fw-bold">儲存裝置</div>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <button class="accordion-button collapsed displayNet" type="button"
                                data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false"
                                aria-controls="collapseThree">
                            </button>
                            <div id="collapseThree" class="accordion-collapse collapse connect"
                                aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    <div class="text fw-bold">連線能力</div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

    </section>






    <script>
        //初始頁面
        const photodiv = document.querySelector('.photo')
        window.onload = function () {
            createImg()
            createColorbtn()
            createDevice()
            createConnect()
            changeRamTitle()
            changeImg()
            changeConnectTitle()
            changePriceOnOtherbtn()
            TotalPrice()
        }
        //資料結構
        const appleData = [
            {
                "id": 1,
                "productName": "ipad Air",
                "firstImg": "iphone-ipad/ipad-air-firstpic.jfif",
                "price": 18900,
                "appearance":
                    [
                        {
                            "Color": "spaceGray",
                            "Name": "太空灰色",
                            "Hex": "#B2B5B7",
                            "imgSrc": "iphone-ipad/ipad-air-select-wifi-spacegray.png"

                        },
                        {
                            "Color": "silver",
                            "Name": "銀色",
                            "Hex": "#DEE0DF",
                            "imgSrc": "iphone-ipad/ipad-air-select-wifi-silver.png"

                        },
                        {
                            "Color": "green",
                            "Name": "綠色",
                            "Hex": "#CDDECA",
                            "imgSrc": "iphone-ipad/ipad-air-select-wifi-green.png"

                        },
                        {
                            "Color": "golden",
                            "Name": "玫瑰金色",
                            "Hex": "#EBCAC3",
                            "imgSrc": "iphone-ipad/ipad-air-select-wifi-gold.png"

                        },
                        {
                            "Color": "skyBlue",
                            "Name": "天藍色",
                            "Hex": "#C9D8E5",
                            "imgSrc": "iphone-ipad/ipad-air-select-wifi-blue.png"

                        }
                    ],
                "spec": [
                    {
                        "specName": "儲存裝置",
                        "detail": [
                            {
                                "type": "spec-capacity-64",
                                "name": "64GB",
                                "fit": 0

                            },
                            {
                                "type": "spec-capacity-256",
                                "name": "256GB",
                                "fit": 5000
                            }
                        ]
                    },
                    {
                        "specName": "連線能力",
                        "detail": [
                            {
                                "type": "spec-onlywifi",
                                "name": "Wi-Fi",
                                "fit": 0
                            },
                            {
                                "type": "spec-wifiandNet",
                                "name": "Wi-Fi+行動網路",
                                "fit": 4300
                            }
                        ]
                    }
                ]
            },
        ]



        
        function createImg() {
            const firstImgUrl = appleData[0].firstImg
            console.log(firstImgUrl)
            const img = document.createElement('img')
            img.setAttribute('class', 'img-fluid')
            img.src = firstImgUrl
            photodiv.appendChild(img)
        }

        function createColorbtn() {
            const appearanceArray = appleData[0].appearance
            appearanceArray.forEach(item => {
                const deviceColordiv = document.querySelector('.device-color')
                const btn = document.createElement('button')
                const p = document.createElement('p')
                const span = document.createElement('span')

                const bgc = item.Hex
                const name = item.Name

                btn.classList.add('btn', 'btn-outline-secondary', 'button', 'color')
                btn.setAttribute('data-bs-toggle', 'collapse')
                btn.setAttribute('data-bs-target', '#collapseOne')

                btn.setAttribute('id', `${item.Color}`) //給每個按鈕id

                span.setAttribute('style', `background-color:${bgc}`)

                p.innerText = name

                btn.append(span, p)

                deviceColordiv.appendChild(btn)

            })
        }

        function createDevice() {
            const deviceDiv = document.querySelector('.device')
            console.log(deviceDiv)
            const firstSpec = appleData[0].spec[0]
            const div = document.createElement('div')
            div.classList.add('d-flex', 'px-4')

            firstSpec.detail.forEach(col => {
                const button = document.createElement('button')
                const priceSpan = document.createElement('span')
                const textSpan = document.createElement('span')
                button.classList.add('btn', 'btn-outline-secondary', 'button', 'd-flex', 'flex-column', 'justify-content-center', 'align-items-center', 'mb-4')

                priceSpan.innerText = appleData[0].price + col.fit
                textSpan.innerText = col.name
                textSpan.classList.add('fs-4')

                button.append(textSpan, priceSpan)
                button.setAttribute('data-bs-toggle', 'collapse')
                button.setAttribute('data-bs-target', '#collapseTwo')
                button.setAttribute('id', `${col.type}`)

                console.log(button)
                div.append(button)
            })
            deviceDiv.append(div)
        }

        function createConnect() {
            const deviceDiv = document.querySelector('.connect')
            console.log(deviceDiv)
            const firstSpec = appleData[0].spec[1]
            const div = document.createElement('div')
            div.classList.add('d-flex', 'px-4')

            firstSpec.detail.forEach(col => {
                const button = document.createElement('button')
                const priceSpan = document.createElement('span')
                const textSpan = document.createElement('span')
                button.classList.add('btn', 'btn-outline-secondary', 'button', 'd-flex', 'flex-column', 'justify-content-center', 'align-items-center', 'mb-4')

                priceSpan.innerText = appleData[0].price + col.fit
                textSpan.innerText = col.name
                textSpan.classList.add('fs-6')

                button.append(textSpan, priceSpan)
                button.setAttribute('data-bs-toggle', 'collapse')
                button.setAttribute('data-bs-target', '#collapseThree')
                button.setAttribute('id', `${col.type}`)

                console.log(button)
                div.append(button)
            })
            deviceDiv.append(div)
        }

        function changeImg() {
            const showColorNameDiv = document.querySelector('.displayColor')

            appleData[0].appearance.forEach(item => {

                const img = document.createElement('img')
                const btn = document.getElementById(item.Color)

                btn.addEventListener('click', function () {

                    photodiv.innerHTML = ""
                    img.setAttribute('src', item.imgSrc)
                    photodiv.append(img)
                    showColorNameDiv.innerText = item.Name

                })

            })
            showColorNameDiv.classList.add('fw-bold')

        }

        function changeRamTitle() {
            const specObj = appleData[0].spec[0]
            const displayRamDiv = document.querySelector('.displayRam')
            specObj.detail.forEach(item => {
                const btn = document.getElementById(item.type)
                btn.addEventListener('click', function () {
                    displayRamDiv.innerText = item.name
                })
            })
            displayRamDiv.classList.add('fw-bold')
        }

        function changeConnectTitle() {
            const connectObj = appleData[0].spec[1]
            const connectDiv = document.querySelector('.displayNet')

            connectObj.detail.forEach(item => {
                const btn = document.getElementById(item.type)
                btn.addEventListener('click', function () {
                    connectDiv.innerText = item.name
                })
            })
            connectDiv.classList.add('fw-bold')
        }

        function changePriceOnOtherbtn() {
            const specObj = appleData[0].spec[0]
            const connectObj = appleData[0].spec[1]

            //按鈕會互相影響價格所以要掛事件在按鈕上面
            specObj.detail.forEach(item => {
                const btn = document.getElementById(item.type)
                btn.addEventListener('click', function () {

                    let price = item.fit + appleData[0].price
                    console.log(price)

                    connectObj.detail.forEach(col => {
                        const connectBtn = document.getElementById(col.type)
                        const span = connectBtn.querySelector('span:nth-child(2)')
                        console.log(span)
                        price += col.fit
                        span.innerText = price
                    })
                })
            })
        }

        function TotalPrice() {
            const connectObj = appleData[0].spec[1]
            const content = document.querySelector('.content')
            const specObj = appleData[0].spec[0]
            const div = document.createElement('div')
            const p =document.createElement('p')

            specObj.detail.forEach(item=>{
                const btn = document.getElementById(item.type)
                btn.addEventListener('click',function(){
                    p.innerHTML=""
                    
                })
            })


            connectObj.detail.forEach(item=>{
                const btn = document.getElementById(item.type)
                btn.addEventListener('click',function(){
                    p.innerHTML=""
                    const span = document.createElement('span')
                    const total = btn.querySelector('span:nth-child(2)').innerText
                    span.innerText = `NT$${total}`
                    p.append(span)
                })
            })
            
            div.classList.add('me-3','fw-bold','mt-3','fs-2','text-end')
            div.append(p)
            content.append(div)
        }



    </script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
</body>

</html>